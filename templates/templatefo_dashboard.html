<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Market Pulse Dashboard</title>
  <meta http-equiv="refresh" content="10">
  <style>
    body { background:#0b1220; color:#e5e7eb; font-family: Arial; }
    table { width:100%; border-collapse:collapse; }
    th,td { padding:10px; border-bottom:1px solid #1f2937; text-align:center; }
    th { background:#0f172a; }
    .BULL { color:#22c55e; font-weight:bold; }
    .BEAR { color:#ef4444; font-weight:bold; }
    .STRONG { color:#22c55e; }
    .MEDIUM { color:#facc15; }
    .WEAK { color:#9ca3af; }
  </style>
</head>
<body>

<h1 style="text-align:center;">ðŸ”¥ Market Pulse</h1>

<table id="tbl">
  <tr>
    <th>Symbol</th>
    <th>Signal</th>
    <th>% Change</th>
    <th>VWAP Î”</th>
    <th>Imbalance</th>
    <th>R-Factor</th>
    <th>Pulse</th>
    <th>Time</th>
  </tr>
</table>

<script>
let batch = 1;

async function loadData(){
  const r = await fetch(`/market-pulse-v2?batch=${batch}`);
  const res = await r.json();
  const data = res.data;

  let rows = `
    <tr>
      <th>Symbol</th>
      <th>Signal</th>
      <th>% Change</th>
      <th>VWAP Î”</th>
      <th>Imbalance</th>
      <th>R-Factor</th>
      <th>Pulse</th>
      <th>Time</th>
    </tr>
  `;

  data.forEach(x => {
    rows += `
      <tr>
        <td>${x.symbol}</td>
        <td class="${x.signal}">${x.signal}</td>
        <td>${x.price_change_pct}%</td>
        <td>${x.vwap_delta}</td>
        <td>${x.imbalance}</td>
        <td>${x.r_factor}</td>
        <td class="${x.pulse}">${x.pulse}</td>
        <td>${x.time}</td>
      </tr>
    `;
  });

  document.getElementById("tbl").innerHTML = rows;

  batch++;
  if (batch > res.total_batches) batch = 1;
}

loadData();
setInterval(loadData, 10000);
</script>

</body>
</html>
