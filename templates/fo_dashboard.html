<!DOCTYPE html>
<html>
<head>
  <title>Market Pulse Dashboard</title>
  <style>
    body {
      background:#0f172a;
      color:white;
      font-family:Arial;
      padding:20px;
    }
    h1 {
      color:#22c55e;
    }
    table {
      width:100%;
      border-collapse:collapse;
      margin-top:20px;
    }
    th, td {
      padding:10px;
      border-bottom:1px solid #334155;
      text-align:center;
    }
    th {
      background:#020617;
    }
    tr:hover {
      background:#020617;
    }
  </style>
</head>
<body>

<h1>ðŸ“ˆ Market Pulse â€“ Intraday Boost</h1>

<table id="tbl">
  <tr>
    <th>Symbol</th>
    <th>Boost Score</th>
    <th>R-Factor</th>
    <th>Signal</th>
    <th>Chart</th>
  </tr>
</table>

<script>
async function loadData() {
  try {
    const r = await fetch("/market-pulse-v2");
    const res = await r.json();

    let rows = `
      <tr>
        <th>Symbol</th>
        <th>Boost Score</th>
        <th>R-Factor</th>
        <th>Signal</th>
        <th>Chart</th>
      </tr>
    `;

    res.data.forEach(x => {
      rows += `
        <tr>
          <td>${x.symbol}</td>

          <td>
            <b>${x.boost_score ?? x.pulse_score ?? "-"}</b>
          </td>

          <td>${x.r_factor}</td>

          <td>
            ${x.signal === "BULL"
              ? "<span style='color:#22c55e;font-weight:bold'>BULL</span>"
              : "<span style='color:#ef4444;font-weight:bold'>BEAR</span>"}
          </td>

          <td>
            <a href="https://www.tradingview.com/chart/?symbol=NSE:${x.symbol}"
               target="_blank"
               style="color:#38bdf8;text-decoration:none;font-weight:bold;">
               ðŸ“ˆ View
            </a>
          </td>
        </tr>
      `;
    });

    document.getElementById("tbl").innerHTML = rows;

  } catch (e) {
    document.body.innerHTML +=
      "<p style='color:red'>JS ERROR: " + e + "</p>";
  }
}

loadData();
</script>

</body>
</html>
