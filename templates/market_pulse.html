<script>
async function loadPulse(){
  const r = await fetch("/market-pulse-v2");
  const res = await r.json();
  const data = res.data;

  let rows = "";
  data.forEach(x => {
    let badge =
      x.pulse === "STRONG" ? "green" :
      x.pulse === "MEDIUM" ? "yellow" : "gray";

    rows += `
      <tr>
        <td>${x.signal}</td>
        <td>${x.symbol}</td>
        <td>${x.price_change_pct}%</td>
        <td>${x.vwap_delta}</td>
        <td><span class="${badge}">${x.pulse}</span></td>
        <td>${x.time}</td>
      </tr>
    `;
  });

  document.getElementById("tbl").innerHTML = rows;
}

loadPulse();
setInterval(loadPulse, 10000);
</script>
